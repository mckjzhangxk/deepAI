from data.analysisUtils import pca,standardizeData,fourierAnalysis,save_fig,show_distribution
import numpy as np
import os
from ML import get_dataset,run_analysis
from data.Beans import Package_FreeGate

'''
out-2-18_1-->(normalize,fft)=(T,T),(T,F)
['010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.058:137->192.168.060.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.175:137->192.168.060.255:137_17', '192.168.060.182:137->192.168.060.255:137_17']
['010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.058:137->192.168.060.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.175:137->192.168.060.255:137_17', '192.168.060.182:137->192.168.060.255:137_17']
['192.168.060.158:35848->150.138.250.048:443_6']
['192.168.060.158:35848->150.138.250.048:443_6']
out-2-18_2-->(normalize,fft)=(T,T),(T,F)
['045.041.188.071:49181->192.168.060.158:41473_17', '192.168.060.158:41473->045.041.188.071:49181_17']
['045.041.188.071:49181->192.168.060.158:41473_17', '192.168.060.158:41473->045.041.188.071:49181_17']
['192.168.060.158:41473->045.041.188.071:49181_17']
['192.168.060.158:41473->045.041.188.071:49181_17']

out-2-15_1-->(normalize,fft)=(T,T),(T,F),windowSize=300
['000.000.000.000:68->255.255.255.255:67_17', '010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '045.041.185.242:19310->192.168.060.158:47166_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.003.011:5353->224.000.000.251:5353_17', '192.168.003.012:5353->224.000.000.251:5353_17', '192.168.003.013:5353->224.000.000.251:5353_17', '192.168.003.014:5353->224.000.000.251:5353_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.020.186:1609->255.255.255.255:20001_17', '192.168.060.040:137->192.168.060.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.158:47166->045.041.185.242:19310_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.190:137->192.168.060.255:137_17']
['010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '045.041.185.242:19310->192.168.060.158:47166_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.158:47166->045.041.185.242:19310_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.190:137->192.168.060.255:137_17']
['192.168.060.158:47166->045.041.185.242:19310_17']
['192.168.060.158:47166->045.041.185.242:19310_17']


out-2-15_2-->(normalize,fft)=(T,T),(T,F),windowSize=300
['000.000.000.000:68->255.255.255.255:67_17', '010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '045.041.185.242:19310->192.168.060.158:47166_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.003.011:5353->224.000.000.251:5353_17', '192.168.003.012:5353->224.000.000.251:5353_17', '192.168.003.013:5353->224.000.000.251:5353_17', '192.168.003.014:5353->224.000.000.251:5353_17', '192.168.020.128:57466->239.255.255.250:3702_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.040:137->192.168.060.255:137_17', '192.168.060.040:57263->239.255.255.250:1900_17', '192.168.060.075:62805->239.255.255.250:3702_17', '192.168.060.099:49853->239.255.255.250:3702_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.158:47166->045.041.185.242:19310_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.190:137->192.168.060.255:137_17', '192.168.237.173:49293->239.255.255.250:3702_17']
['010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.190:137->192.168.060.255:137_17']
['045.041.185.242:19310->192.168.060.158:47166_17', '192.168.060.158:47166->045.041.185.242:19310_17']
['045.041.185.242:19310->192.168.060.158:47166_17', '192.168.060.158:47166->045.041.185.242:19310_17']

out-2-15_3-->(normalize,fft)=(T,T),(T,F),windowSize=300
['000.000.000.000:68->255.255.255.255:67_17', '010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '045.041.185.242:19310->192.168.060.158:47166_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.003.011:5353->224.000.000.251:5353_17', '192.168.003.012:5353->224.000.000.251:5353_17', '192.168.003.013:5353->224.000.000.251:5353_17', '192.168.003.014:5353->224.000.000.251:5353_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.040:137->192.168.060.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.158:47166->045.041.185.242:19310_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.190:137->192.168.060.255:137_17']
['010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '010.010.030.119:137->010.010.030.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.190:137->192.168.060.255:137_17']
['192.168.060.158:34804->045.041.185.242:19310_17']
['192.168.060.158:34804->045.041.185.242:19310_17']

out-2-19-->(normalize,fft)=(T,T),(T,F),windowSize=300
['010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '169.254.056.012:137->169.254.255.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.019:137->192.168.060.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.179:60175->255.255.255.255:137_17', '192.168.060.182:137->192.168.060.255:137_17']
['010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '169.254.056.012:137->169.254.255.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.019:137->192.168.060.255:137_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.179:60175->255.255.255.255:137_17', '192.168.060.182:137->192.168.060.255:137_17']
['010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '169.254.056.012:137->169.254.255.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.003.011:5353->224.000.000.251:5353_17', '192.168.003.012:5353->224.000.000.251:5353_17', '192.168.003.013:5353->224.000.000.251:5353_17', '192.168.003.014:5353->224.000.000.251:5353_17', '192.168.020.045:62758->192.168.020.142:61477_17', '192.168.020.045:65511->192.168.020.142:52472_17', '192.168.020.128:55676->239.255.255.250:3702_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.019:137->192.168.060.255:137_17', '192.168.060.040:137->192.168.060.255:137_17', '192.168.060.075:62111->239.255.255.250:3702_17', '192.168.060.093:1900->239.255.255.250:1900_17', '192.168.060.093:56039->239.255.255.250:3702_17', '192.168.060.093:62487->239.255.255.250:3702_17', '192.168.060.099:61710->239.255.255.250:3702_17', '192.168.060.100:52861->239.255.255.250:3702_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.179:60175->255.255.255.255:137_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.060.224:56377->239.255.255.250:3702_17', '192.168.237.173:54732->239.255.255.250:3702_17']
['010.010.010.125:137->010.255.255.255:137_17', '010.010.010.223:137->010.255.255.255:137_17', '169.254.056.012:137->169.254.255.255:137_17', '172.016.005.255:137->172.016.255.255:137_17', '192.168.003.013:5353->224.000.000.251:5353_17', '192.168.003.014:5353->224.000.000.251:5353_17', '192.168.020.128:55676->239.255.255.250:3702_17', '192.168.020.172:137->192.168.020.255:137_17', '192.168.060.019:137->192.168.060.255:137_17', '192.168.060.075:62111->239.255.255.250:3702_17', '192.168.060.093:56039->239.255.255.250:3702_17', '192.168.060.093:62487->239.255.255.250:3702_17', '192.168.060.099:61710->239.255.255.250:3702_17', '192.168.060.100:52861->239.255.255.250:3702_17', '192.168.060.150:137->192.168.060.255:137_17', '192.168.060.179:60175->255.255.255.255:137_17', '192.168.060.182:137->192.168.060.255:137_17', '192.168.237.173:54732->239.255.255.250:3702_17']
'''

paths=[
    '/home/zhangxk/AIProject/ippack/ip_capture/out-2-18_1',
    '/home/zhangxk/AIProject/ippack/ip_capture/out-2-18_2',
    '/home/zhangxk/AIProject/ippack/ip_capture/out-2-15_1',
    '/home/zhangxk/AIProject/ippack/ip_capture/out-2-15_2',
    '/home/zhangxk/AIProject/ippack/ip_capture/out-2-15_3',
    '/home/zhangxk/AIProject/ippack/ip_capture/out-2-19'
]
features=['upcount','up_rate','downcount','downsize','down_rate']
for path in paths:
    db,np_db=get_dataset(path,features,False,False,windowSize=30,beanFunc=Package_FreeGate)
    rs = run_analysis(np_db, db, window=16 * 6, threshold=0.5)
    print(path,'\n',rs)
# basepath='/home/zhangxk/projects/deepAI/ippackage/data/debug/1'
# for i,feature in enumerate(features):
#     save_fig(np_db[:,:,i],'%s/%s.jpg'%(basepath,feature),True)
