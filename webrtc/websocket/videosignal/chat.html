<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Realtime communication with WebRTC</title>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.0/socket.io.js"></script>
</head>

<body>

  <h1>Realtime communication with WebRTC</h1>
  <div>
      
      <ul  id="newPeople">
      </ul>
  </div>
  <div>
      <span>room</span><input type="text" value="abc"  id='room'/>    
      <span>name</span><input type="text"  id='username'/>    
      
      <button onclick="join()">join</button>
  </div>
  <div>
      <textarea style="width: 300px;height: 300px;" id="content"></textarea>
    <button onclick="send()">send</button>
    </div>

    <div>
      <span>receive:</span>
      <div id="receive">

      </div>
    </div>
</body>
<script>
 
  let socket = io(location.origin);

  function send(){
    socket.emit('message',{
      'username':username.value,
      'message':content.value
    })
    content.value=''
  }

  
  function join(){
    socket.emit('createOrJoin',{
      'room':room.value,
      'username':username.value,
    })
  }

  socket.on('join',(message)=>{
    newPeople.innerHTML=newPeople.innerHTML+`<li>${message["username"]}</li>`
  })

  socket.on('joined',(message)=>{
    newPeople.innerHTML=newPeople.innerHTML+`<li>${message["username"]}</li>`
  })

  socket.on('message',(data)=>{
    receive.innerHTML=receive.innerHTML+`<p>${data["username"]}ï¼š${data["message"]}</p>`
  })
</script>
</html>
